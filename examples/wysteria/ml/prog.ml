open AST

open FFI

let const_meta = AST.Meta ([], AST.Can_b, [], AST.Can_w)

let program = mk_let (mk_varname "alice_s" (T_eprins)) (mk_ffi 1 "FFI.singleton" (FFI.singleton) [  (mk_var "alice" (T_prin)); ] (fun x -> D_v (const_meta, V_eprins x))) (mk_let (mk_varname "bob_s" (T_eprins)) (mk_ffi 1 "FFI.singleton" (FFI.singleton) [  (mk_var "bob" (T_prin)); ] (fun x -> D_v (const_meta, V_eprins x))) (mk_let (mk_varname "ab" (T_cons ("Prins.eprins", []))) (mk_ffi 2 "FFI.union" (FFI.union) [  (mk_var "alice_s" (T_eprins)); (mk_var "bob_s" (T_eprins)); ] (fun x -> D_v (const_meta, V_eprins x))) (mk_let (mk_varname "read_fn" (T_unknown)) (mk_abs (mk_varname "x" (T_unit)) (mk_ffi 1 "FFI.read_int" FFI.read_int [ E_const (C_unit ()) ] (fun x -> mk_v_opaque x slice_id compose_ids slice_id_sps))) (mk_let (mk_varname "sort" (T_unknown)) (mk_abs (mk_varname "x1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "x2" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y2" (T_cons ("Prims.int", []))) (mk_app (mk_var "failwith" (T_unknown)) (mk_const (C_opaque ((), Obj.magic ("Not yet implemented:sort"), T_unknown)))))))) (mk_let (mk_varname "median_spec" (T_unknown)) (mk_abs (mk_varname "x1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "x2" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y2" (T_cons ("Prims.int", []))) (mk_const (C_unit ())))))) (mk_let (mk_varname "monolithic_median" (T_unknown)) (mk_abs (mk_varname "x1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "x2" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y2" (T_cons ("Prims.int", []))) (mk_let (mk_varname "a" (T_bool)) (mk_ffi 2 "Prims.(>)" (Prims.(>)) [  (mk_var "x1" (T_cons ("Prims.int", []))); (mk_var "y1" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_bool x))) (mk_let (mk_varname "x3" (T_cons ("Prims.int", []))) (mk_cond (mk_var "a" (T_bool)) (mk_var "x1" (T_cons ("Prims.int", []))) (mk_var "x2" (T_cons ("Prims.int", [])))) (mk_let (mk_varname "y3" (T_cons ("Prims.int", []))) (mk_cond (mk_var "a" (T_bool)) (mk_var "y2" (T_cons ("Prims.int", []))) (mk_var "y1" (T_cons ("Prims.int", [])))) (mk_let (mk_varname "d" (T_bool)) (mk_ffi 2 "Prims.(>)" (Prims.(>)) [  (mk_var "x3" (T_cons ("Prims.int", []))); (mk_var "y3" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_bool x))) (mk_cond (mk_var "d" (T_bool)) (mk_var "y3" (T_cons ("Prims.int", []))) (mk_var "x3" (T_cons ("Prims.int", [])))))))))))) (mk_let (mk_varname "monolithic_median_correctness" (T_unknown)) (mk_abs (mk_varname "x1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "x2" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y1" (T_cons ("Prims.int", []))) (mk_abs (mk_varname "y2" (T_cons ("Prims.int", []))) (mk_const (C_unit ())))))) (mk_let (mk_varname "mono_median" (T_unknown)) (mk_abs (mk_varname "_15_62" (T_unit)) (mk_let (mk_varname "x1" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "alice_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "x2" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "alice_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "y1" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "bob_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "y2" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "bob_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "g" (T_unknown)) (mk_abs (mk_varname "_15_68" (T_unit)) (mk_let (mk_varname "x1" (T_cons ("Prims.int", []))) (mk_unbox (mk_var "x1" (T_box (T_cons ("Prims.int", []))))) (mk_let (mk_varname "x2" (T_cons ("Prims.int", []))) (mk_unbox (mk_var "x2" (T_box (T_cons ("Prims.int", []))))) (mk_let (mk_varname "y1" (T_cons ("Prims.int", []))) (mk_unbox (mk_var "y1" (T_box (T_cons ("Prims.int", []))))) (mk_let (mk_varname "y2" (T_cons ("Prims.int", []))) (mk_unbox (mk_var "y2" (T_box (T_cons ("Prims.int", []))))) (mk_let (mk_varname "a" (T_bool)) (mk_ffi 2 "Prims.(>)" (Prims.(>)) [  (mk_var "x1" (T_cons ("Prims.int", []))); (mk_var "y1" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_bool x))) (mk_let (mk_varname "x3" (T_cons ("Prims.int", []))) (mk_cond (mk_var "a" (T_bool)) (mk_var "x1" (T_cons ("Prims.int", []))) (mk_var "x2" (T_cons ("Prims.int", [])))) (mk_let (mk_varname "y3" (T_cons ("Prims.int", []))) (mk_cond (mk_var "a" (T_bool)) (mk_var "y2" (T_cons ("Prims.int", []))) (mk_var "y1" (T_cons ("Prims.int", [])))) (mk_let (mk_varname "d" (T_bool)) (mk_ffi 2 "Prims.(>)" (Prims.(>)) [  (mk_var "x3" (T_cons ("Prims.int", []))); (mk_var "y3" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_bool x))) (mk_cond (mk_var "d" (T_bool)) (mk_var "y3" (T_cons ("Prims.int", []))) (mk_var "x3" (T_cons ("Prims.int", []))))))))))))) (mk_assec (mk_var "ab" (T_cons ("Prins.eprins", []))) (mk_var "g" (T_unknown))))))))) (mk_let (mk_varname "opt_median" (T_unknown)) (mk_abs (mk_varname "_15_79" (T_unit)) (mk_let (mk_varname "x1" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "alice_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "x2" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "alice_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "y1" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "bob_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "y2" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "bob_s" (T_eprins)) (mk_var "read_fn" (T_unknown))) (mk_let (mk_varname "cmp" (T_unknown)) (mk_abs (mk_varname "x" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "y" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "_15_87" (T_unit)) (mk_ffi 2 "Prims.(>)" (Prims.(>)) [  (mk_unbox (mk_var "x" (T_box (T_cons ("Prims.int", []))))); (mk_unbox (mk_var "y" (T_box (T_cons ("Prims.int", []))))); ] (fun x -> D_v (const_meta, V_bool x)))))) (mk_let (mk_varname "select" (T_unknown)) (mk_abs (mk_varname "p" (T_prin)) (mk_abs (mk_varname "b" (T_bool)) (mk_abs (mk_varname "n1" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "n2" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "_15_101" (T_unit)) (mk_cond (mk_var "b" (T_bool)) (mk_unbox (mk_var "n1" (T_box (T_cons ("Prims.int", []))))) (mk_unbox (mk_var "n2" (T_box (T_cons ("Prims.int", []))))))))))) (mk_let (mk_varname "select_s" (T_unknown)) (mk_abs (mk_varname "b" (T_bool)) (mk_abs (mk_varname "n1" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "n2" (T_box (T_cons ("Prims.int", [])))) (mk_abs (mk_varname "_15_116" (T_unit)) (mk_cond (mk_var "b" (T_bool)) (mk_unbox (mk_var "n2" (T_box (T_cons ("Prims.int", []))))) (mk_unbox (mk_var "n1" (T_box (T_cons ("Prims.int", [])))))))))) (mk_let (mk_varname "g" (T_unknown)) (mk_abs (mk_varname "_15_127" (T_unit)) (mk_let (mk_varname "a" (T_bool)) (mk_assec (mk_var "ab" (T_cons ("Prins.eprins", []))) (mk_app (mk_app (mk_var "cmp" (T_unknown)) (mk_var "x1" (T_box (T_cons ("Prims.int", []))))) (mk_var "y1" (T_box (T_cons ("Prims.int", [])))))) (mk_let (mk_varname "x3" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "alice_s" (T_eprins)) (mk_app (mk_app (mk_app (mk_app (mk_var "select" (T_unknown)) (mk_var "alice" (T_prin))) (mk_var "a" (T_bool))) (mk_var "x1" (T_box (T_cons ("Prims.int", []))))) (mk_var "x2" (T_box (T_cons ("Prims.int", [])))))) (mk_let (mk_varname "y3" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "bob_s" (T_eprins)) (mk_app (mk_app (mk_app (mk_app (mk_var "select" (T_unknown)) (mk_var "bob" (T_prin))) (mk_var "a" (T_bool))) (mk_var "y2" (T_box (T_cons ("Prims.int", []))))) (mk_var "y1" (T_box (T_cons ("Prims.int", [])))))) (mk_let (mk_varname "d" (T_bool)) (mk_assec (mk_var "ab" (T_cons ("Prins.eprins", []))) (mk_app (mk_app (mk_var "cmp" (T_unknown)) (mk_var "x3" (T_box (T_cons ("Prims.int", []))))) (mk_var "y3" (T_box (T_cons ("Prims.int", [])))))) (mk_let (mk_varname "r" (T_cons ("Prims.int", []))) (mk_assec (mk_var "ab" (T_cons ("Prins.eprins", []))) (mk_app (mk_app (mk_app (mk_var "select_s" (T_unknown)) (mk_var "d" (T_bool))) (mk_var "x3" (T_box (T_cons ("Prims.int", []))))) (mk_var "y3" (T_box (T_cons ("Prims.int", [])))))) (mk_var "r" (T_cons ("Prims.int", []))))))))) (mk_let (mk_varname "_33_206" (T_box (T_cons ("Prims.int", [])))) (mk_aspar (mk_var "ab" (T_cons ("Prins.eprins", []))) (mk_var "g" (T_unknown))) (mk_unbox (mk_var "_33_206" (T_box (T_cons ("Prims.int", []))))))))))))))) (mk_let (mk_varname "x" (T_cons ("Prims.int", []))) (mk_app (mk_var "mono_median" (T_unknown)) (E_const (C_unit ()))) (mk_let (mk_varname "_15_141" (T_unit)) (mk_ffi 1 "FFI.print_int" (FFI.print_int) [  (mk_var "x" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_unit))) (mk_let (mk_varname "y" (T_cons ("Prims.int", []))) (mk_app (mk_var "opt_median" (T_unknown)) (E_const (C_unit ()))) (mk_ffi 1 "FFI.print_int" (FFI.print_int) [  (mk_var "y" (T_cons ("Prims.int", []))); ] (fun x -> D_v (const_meta, V_unit)))))))))))))))

